actions:
  - name: Build
    os: "darwin"
    triggers:
      push:
        branches:
          - "main"
      pull_request:
        branches:
          - "*"
    bazel_commands:
      - "build --config=workflows //..."

  - name: Test
    os: "darwin"
    triggers:
      push:
        branches:
          - "main"
      pull_request:
        branches:
          - "*"
    git_clean_exclude:
      - bazel-output-base
    bazel_commands:
      - "--output_base=bazel-output-base test --config=workflows //examples/... //tools/... //test/..."

  - name: Integration Test
    os: "darwin"
    triggers:
      push:
        branches:
          - "main"
      pull_request:
        branches:
          - "*"
    git_clean_exclude:
      - examples/ios_app/bazel-output-base
    bazel_workspace_dir: examples/ios_app
    bazel_commands:
      - "--output_base=bazel-output-base test --config=workflows //test/..."

  - name: Buildifier Lint
    triggers:
      push:
        branches:
          - "main"
      pull_request:
        branches:
          - "*"
    bazel_commands:
      - "run --config=workflows //:buildifier.check"

  - name: Docs
    triggers:
      push:
        branches:
          - "main"
      pull_request:
        branches:
          - "*"
    bazel_commands:
      - "test --config=workflows //doc:diff_test"
